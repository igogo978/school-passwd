<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <title> images upload</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script
          src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.16/vue.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>

<div th:insert="fragments/header :: navbar"></div>
<div class="container">

  <div class="form-group">

    <h2>Upload images</h2>

    <form method="POST" enctype="multipart/form-data"
          th:action="@{'upload'}">

      <div class="input-group mb-1">
        <input type="file" name="file" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-lg">

          <button class="btn btn-outline-secondary"
                  type="submit"
                  value="Upload">確定上傳</button>

      </div>

      <div class="input-group mb-1">
        <div class="input-group-prepend">

        </div>

      </div>

    </form>

  </div>

  <div th:if="${error}">
    <div class="alert alert-warning" role="alert">您所選擇的副檔名不正確喔</div>
  </div>

</div>

<footer>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script th:inline="javascript">
                /*<![CDATA[*/

                Vue.prototype.$http = axios;
                let config = {
                    headers: {
                        'content-type': 'application/json;CHARSET=UTF-8'
                    }
                };

                var app = new Vue({
                    el: '#app',
                    data: {
                        msg: 'Hello Vue!',

                    },
                    created: function() {



                    },
                    computed: {

                    },
                    methods: {

                        say: function(){
                            console.log("download area scores xlsx");
                            let config = {
                            headers: {
                                'content-type': 'application/json;CHARSET=UTF-8'
                            },
                            responseType: 'arraybuffer'
                            };

                            let url = "/api/scores/area/download";
                            let vm = this;
                            this.$http.get(url, config)
                                .then((response) => {
                                    var blob = new Blob([response.data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                                    saveAs(blob, 'area.xlsx');
                                });
                        },

                    }
                })

                 /*]]>*/
                </script>


</footer>


</body>
</html>
